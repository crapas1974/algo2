# 제귀 호출의 제한
---

## 예시 코드에 대하여

```python
import sys

def sum(n):
    if n == 0:
        return 0
    else:
        return n + sum(n - 1)
        
print(f"1에서 500까지의 합 : {sum(500)}")
print(f"1에서 1500까지의 합 : {sum(1500)}")
```

- 예시 코드를 실행한 결과는 다음과 같다.
~~~
1에서 500까지의 합 : 125250
Traceback (most recent call last):
    ...
RecursionError: maximum recursion depth exceeded in comparison    
~~~
- `sum(500)`은 정상적으로 실행이 되지만 `sum(1500)`은 RecursionError가 발생한다.
- 파이썬의 RecursionError는 재귀 호출이 너무 깊어져서 스택 메모리의 한계를 초과했을 때 발생하는 오류이다.
- 이 오류는 '스택 오버플로우' 현상을 방지하기 위해서 미리 발생하는 오류이다.

## 스택 오버플로우에 대하여

- 컴퓨터 시스템의 스택 메모리는 제한된 크기를 갖는다. 이 크기를 초과해서 사용하는 경우 스택 오버플로우 현상이 발생한다.
- 스택 오버플로우로 인해서 발생할 수 있는 일은 다음과 같다.
    - 프로그램의 비정상 동작 또는 종료
        - 스택 메모리가 부족한 경우, 프로그램은 더 이상 정상적으로 동작할 수 없다.
        - 대부분의 경우 프로그램은 비정상적인 종료 상황을 맞이하게 된다.
        - 프로그램 간에 충돌이 발생하기도 한다.
    - 보안 취약점 발생
        - 스택 오버플로우는 비정상적인 메모리 상황을 야기하며, 이로 인해서 보안 문제를 야기할 수 있다.
        - 스택 오버플로우에 인한 문제를 예방하기 위해서 최신 운영체제 및 컴파일러, 인터프리터 등에 많은 보완이 이루어졌지만, 여전히 잠재적인 보안 위험 요소이다.
    - 시스템 안정성의 저하
        - 시스템과 중요한 관련이 있는 소프트웨어에서 스택 오버플로우가 발생하면 시스템의 안정성에 문제가 발생할 수 있다.

## 파이썬이 스택 오버플로우를 대비하는 방법

- 파이썬에서는 재귀 호출의 깊이를 제한하고 있다.
- 파이썬에서 제한하고 있는 재귀 호출 깊이의 제한 값을 알고 싶으면 `sys` 모듈의 `sys.getrecursionlimit()` 함수를 통해 확인할 수 있다.
~~~
>>> import sys
>>> print(sys.getrecursionlimit())
1000
~~~
- 일반적인 경우의 기본 제한값은 `1000`이다.
- 이 제한을 일시적으로 회피하기 위해서는 `sys.setrecursionlimit()` 함수를 사용하면 된다.
```
>>> sys.setrecursionlimit(1500)
>>> print(sys.getrecursionlimit())
1500
```
- 이 방법을 사용해 예제의 코드를 다음과 같이 수정할 수 있다.

```python
import sys
sys.setrecursionlimit(2000)
def sum(n):
    if n == 0:
        return 0
    else:
        return n + sum(n - 1)
        
print(f"1에서 500까지의 합 : {sum(500)}")
print(f"1에서 1500까지의 합 : {sum(1500)}")
```
